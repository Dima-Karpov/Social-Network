{"ast":null,"code":"import _regeneratorRuntime from\"D:/My-proect/social-network/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"D:/My-proect/social-network/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _toConsumableArray from\"D:/My-proect/social-network/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _objectSpread from\"D:/My-proect/social-network/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import{usersAPI}from'../api/api';var FOLLOW='FOLLOW';var UNFOLLOW='UNFOLLOW';var SET_USERS='SET-USERS';var SET_CURRENT_PAGE='SET-CURRENT-PAGE';var SET_TOTAL_USER_COUNT='SET-TOTAL-USERS-COUNT';var TOGGEL_IS_FETCHING='TOGGEL-IS-FETCHING';var TOGGEL_IN_FOLLOWING_PROGRESS='TOGGEK-IN-PROGRESS';var initialState={users:[],pageSize:10,totalUsersCount:100,carrentPage:1,isFeching:false,followingInProgress:[]};var usersReducer=function usersReducer(){var state=arguments.length>0&&arguments[0]!==undefined?arguments[0]:initialState;var action=arguments.length>1?arguments[1]:undefined;switch(action.type){case FOLLOW:{return _objectSpread(_objectSpread({},state),{},{users:state.users.map(function(u){if(u.id===action.userID){return _objectSpread(_objectSpread({},u),{},{followed:true});}return u;})});}case UNFOLLOW:{return _objectSpread(_objectSpread({},state),{},{users:state.users.map(function(u){if(u.id===action.userID){return _objectSpread(_objectSpread({},u),{},{followed:false});}return u;})});}case SET_USERS:{return _objectSpread(_objectSpread({},state),{},{users:action.users});}case SET_CURRENT_PAGE:{return _objectSpread(_objectSpread({},state),{},{carrentPage:action.carrentPage});}case SET_TOTAL_USER_COUNT:{return _objectSpread(_objectSpread({},state),{},{carrentPage:action.count});}case TOGGEL_IS_FETCHING:{return _objectSpread(_objectSpread({},state),{},{isFeching:action.isFetching});}case TOGGEL_IN_FOLLOWING_PROGRESS:{return _objectSpread(_objectSpread({},state),{},{followingInProgress:action.isFetching?[].concat(_toConsumableArray(state.followingInProgress),[action.userID]):state.followingInProgress.filter(function(id){return id!==action.userID;})});}default:return state;}};export var follow=function follow(userID){return{type:FOLLOW,userID:userID};};export var unfollow=function unfollow(userID){return{type:UNFOLLOW,userID:userID};};export var setUsers=function setUsers(users){return{type:SET_USERS,users:users};};export var setCarrentPageAC=function setCarrentPageAC(carrentPage){return{type:SET_CURRENT_PAGE,carrentPage:carrentPage};};export var setTotalUserCount=function setTotalUserCount(totalUsersCount){return{type:SET_TOTAL_USER_COUNT,count:totalUsersCount};};export var toggelIsFetching=function toggelIsFetching(isFetching){return{type:TOGGEL_IS_FETCHING,isFetching:isFetching};};export var toggelInProgress=function toggelInProgress(isFetching,userID){return{type:TOGGEL_IN_FOLLOWING_PROGRESS,isFetching:isFetching,userID:userID};};export var getUsersThunkCreator=function getUsersThunkCreator(currentPage,pageSize){return/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(dispatch){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:dispatch(toggelIsFetching(true));usersAPI.getUsers(currentPage,pageSize).then(function(data){dispatch(toggelIsFetching(false));dispatch(setUsers(data.items));dispatch(setTotalUserCount(data.totalCount));});case 2:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}();};export var followThunkCreator=function followThunkCreator(usersID){return/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(dispatch){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:dispatch(toggelInProgress(true,usersID));usersAPI.follow(usersID).then(function(response){if(response.data.resultCode===0){dispatch(follow(usersID));}dispatch(toggelInProgress(false,usersID));});case 2:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x2){return _ref2.apply(this,arguments);};}();};export var unFollowThunkCreator=function unFollowThunkCreator(usersID){return/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(dispatch){return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:dispatch(toggelInProgress(true,usersID));usersAPI.unfollow(usersID).then(function(response){if(response.data.resultCode===0){dispatch(unfollow(usersID));}dispatch(toggelInProgress(false,usersID));});case 2:case\"end\":return _context3.stop();}}},_callee3);}));return function(_x3){return _ref3.apply(this,arguments);};}();};export default usersReducer;","map":{"version":3,"sources":["D:/My-proect/social-network/src/redux/users-reducer.tsx"],"names":["usersAPI","FOLLOW","UNFOLLOW","SET_USERS","SET_CURRENT_PAGE","SET_TOTAL_USER_COUNT","TOGGEL_IS_FETCHING","TOGGEL_IN_FOLLOWING_PROGRESS","initialState","users","pageSize","totalUsersCount","carrentPage","isFeching","followingInProgress","usersReducer","state","action","type","map","u","id","userID","followed","count","isFetching","filter","follow","unfollow","setUsers","setCarrentPageAC","setTotalUserCount","toggelIsFetching","toggelInProgress","getUsersThunkCreator","currentPage","dispatch","getUsers","then","data","items","totalCount","followThunkCreator","usersID","response","resultCode","unFollowThunkCreator"],"mappings":"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","sourcesContent":["import { ThunkAction } from 'redux-thunk'\r\nimport { usersAPI } from '../api/api';\r\nimport { AppStateType } from './redux-store';\r\n\r\ntype PhotosType = {\r\n    small: null\r\n    large: null\r\n}\r\ntype LocationType = {\r\n    city: string\r\n    country: string\r\n}\r\nexport type UsersType = {\r\n    id: number\r\n    photos: PhotosType\r\n    followed: boolean\r\n    name: string\r\n    status: string\r\n    location: LocationType\r\n};\r\n\r\ntype ActionType = ReturnType<typeof follow>\r\n    | ReturnType<typeof unfollow>\r\n    | ReturnType<typeof setUsers>\r\n    | ReturnType<typeof setCarrentPageAC>\r\n    | ReturnType<typeof setTotalUserCount>\r\n    | ReturnType<typeof toggelIsFetching>\r\n    | ReturnType<typeof toggelInProgress>\r\n\r\nexport type InitialStateType = typeof initialState\r\n\r\nconst FOLLOW = 'FOLLOW';\r\nconst UNFOLLOW = 'UNFOLLOW';\r\nconst SET_USERS = 'SET-USERS';\r\nconst SET_CURRENT_PAGE = 'SET-CURRENT-PAGE';\r\nconst SET_TOTAL_USER_COUNT = 'SET-TOTAL-USERS-COUNT';\r\nconst TOGGEL_IS_FETCHING = 'TOGGEL-IS-FETCHING';\r\nconst TOGGEL_IN_FOLLOWING_PROGRESS = 'TOGGEK-IN-PROGRESS';\r\n\r\nconst initialState = {\r\n    users: [] as Array<UsersType>,\r\n    pageSize: 10,\r\n    totalUsersCount: 100,\r\n    carrentPage: 1,\r\n    isFeching: false,\r\n    followingInProgress: [] as Array<number>,\r\n};\r\n\r\n\r\nconst usersReducer = (state: InitialStateType = initialState, action: ActionType): InitialStateType => {\r\n\r\n    switch (action.type) {\r\n        case FOLLOW: {\r\n            return {\r\n                ...state,\r\n                users: state.users.map(u => {\r\n                    if (u.id === action.userID) {\r\n                        return {\r\n                            ...u,\r\n                            followed: true\r\n                        }\r\n                    }\r\n                    return u\r\n                })\r\n            }\r\n        }\r\n        case UNFOLLOW: {\r\n            return {\r\n                ...state,\r\n                users: state.users.map(u => {\r\n                    if (u.id === action.userID) {\r\n                        return {\r\n                            ...u,\r\n                            followed: false\r\n                        }\r\n                    }\r\n                    return u\r\n                })\r\n            }\r\n        }\r\n        case SET_USERS: {\r\n            return {\r\n                ...state,\r\n                users: action.users\r\n            }\r\n        }\r\n        case SET_CURRENT_PAGE: {\r\n            return {\r\n                ...state,\r\n                carrentPage: action.carrentPage\r\n            }\r\n        }\r\n        case SET_TOTAL_USER_COUNT: {\r\n            return {\r\n                ...state,\r\n                carrentPage: action.count\r\n            }\r\n        }\r\n        case TOGGEL_IS_FETCHING: {\r\n            return {\r\n                ...state, isFeching: action.isFetching\r\n            }\r\n        }\r\n        case TOGGEL_IN_FOLLOWING_PROGRESS: {\r\n            return {\r\n                ...state,\r\n                followingInProgress: action.isFetching\r\n                ? [...state.followingInProgress, action.userID]\r\n                : state.followingInProgress.filter(id => id !== action.userID)\r\n            }\r\n        }\r\n\r\n        default:\r\n            return state;\r\n    }\r\n}\r\n\r\nexport const follow = (userID: number) => {\r\n    return {\r\n        type: FOLLOW,\r\n        userID: userID\r\n    } as const\r\n};\r\nexport const unfollow = (userID: number) => {\r\n    return {\r\n        type: UNFOLLOW,\r\n        userID: userID\r\n    } as const\r\n};\r\nexport const setUsers = (users: Array<UsersType>) => {\r\n    return {\r\n        type: SET_USERS,\r\n        users: users\r\n    } as const\r\n};\r\nexport const setCarrentPageAC = (carrentPage: number) => {\r\n    return {\r\n        type: SET_CURRENT_PAGE,\r\n        carrentPage,\r\n    } as const\r\n}\r\nexport const setTotalUserCount = (totalUsersCount: number) => {\r\n    return {\r\n        type: SET_TOTAL_USER_COUNT,\r\n        count: totalUsersCount,\r\n    } as const\r\n}\r\nexport const toggelIsFetching = (isFetching: boolean) => {\r\n    return {\r\n        type: TOGGEL_IS_FETCHING,\r\n        isFetching,\r\n    } as const\r\n}\r\nexport const toggelInProgress = (isFetching: boolean, userID: number) => {\r\n    return {\r\n        type: TOGGEL_IN_FOLLOWING_PROGRESS,\r\n        isFetching,\r\n        userID,\r\n    } as const\r\n}\r\n\r\n\r\n\r\nexport const getUsersThunkCreator = (currentPage: number, pageSize: number): ThunkAction<Promise<void>, AppStateType, unknown, ActionType> => {\r\n\r\n    return async (dispatch) => {\r\n        dispatch(toggelIsFetching(true));\r\n        usersAPI.getUsers(currentPage, pageSize)\r\n            .then(data => {\r\n                dispatch(toggelIsFetching(false));\r\n                dispatch(setUsers(data.items))\r\n                dispatch(setTotalUserCount(data.totalCount))\r\n            })\r\n    }\r\n\r\n};\r\n\r\nexport const followThunkCreator = (usersID: number): ThunkAction<Promise<void>, AppStateType, unknown, ActionType> => {\r\n\r\n    return async (dispatch) => {\r\n        dispatch(toggelInProgress(true, usersID));\r\n        usersAPI.follow(usersID)\r\n            .then(response => {\r\n                if (response.data.resultCode === 0) {\r\n                    dispatch(follow(usersID));\r\n                }\r\n                dispatch(toggelInProgress(false, usersID));\r\n            })\r\n    }\r\n};\r\n\r\nexport const unFollowThunkCreator = (usersID: number): ThunkAction<Promise<void>, AppStateType, unknown, ActionType> => {\r\n\r\n    return async (dispatch) => {\r\n        dispatch(toggelInProgress(true, usersID));\r\n        usersAPI.unfollow(usersID)\r\n            .then(response => {\r\n                if (response.data.resultCode === 0) {\r\n                    dispatch(unfollow(usersID));\r\n                }\r\n                dispatch(toggelInProgress(false, usersID));\r\n            })\r\n    }\r\n};\r\n\r\nexport default usersReducer"]},"metadata":{},"sourceType":"module"}